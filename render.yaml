services:
  - type: web
    name: pro      - key: FRONTEND_URL
        value: https://proyfrontendgrupo06-1.onrender.comrontendgrupo06
    env: node
    plan: free
    buildCommand: |
      echo "ğŸ” Starting build process..."
      echo "ğŸ“‚ Current directory: $(pwd)"
      echo "ğŸ“‹ Listing files:"
      ls -la
      echo "ğŸ” Node version: $(node --version)"
      echo "ğŸ” NPM version: $(npm --version)"
      echo "ğŸ“¦ Installing dependencies..."
      rm -rf node_modules package-lock.json pnpm-lock.yaml
      pnpm install --no-frozen-lockfile --production=false
      echo "ğŸ”§ Installing angularx-qrcode specifically..."
      pnpm install angularx-qrcode@^20.0.0
      echo "ğŸ” Verifying angularx-qrcode installation..."
      ls -la node_modules/angularx-qrcode/ || echo "âš ï¸ angularx-qrcode not found"
      echo "ğŸ” Verifying Angular CLI installation..."
      if [ -f "node_modules/.bin/ng" ]; then
        echo "âœ… Angular CLI found in node_modules"
        ./node_modules/.bin/ng version
      else
        echo "âš ï¸ Angular CLI not found in node_modules, installing globally..."
        npm install -g @angular/cli@latest
      fi
      echo "ğŸ”§ Clearing Angular cache..."
      npx ng cache clean || echo "Cache clean skipped"
      echo "ğŸ”¨ Building application..."
      npx @angular/cli@latest build --configuration production --verbose --preserve-symlinks
      echo "ğŸ” Checking build output..."
      if [ -d "dist" ]; then
        echo "âœ… dist directory created"
        find dist -type f -name "index.html" -exec echo "ğŸ“„ Found index.html at: {}" \;
      else
        echo "âŒ dist directory not found"
        exit 1
      fi
      echo "ğŸ”§ Running postbuild script..."
      node postbuild.js
      echo "âœ… Build process completed"
    startCommand: bash start-server.sh
    envVars:
      - key: NODE_ENV
        value: production
      - key: FRONTEND_URL
        value: https://proyfrontendgrupo06-1.onrender.com
      - key: BACKEND_URL
        value: https://trabajo-final-psw.onrender.com
